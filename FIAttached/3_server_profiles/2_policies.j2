---
ClassId: storage.StoragePolicy
Name: {{prefix}}fi-control-M.2
Organization: {{organization}}
#settings
M2VirtualDrive:
  ClassId: storage.M2VirtualDriveConfig
  ObjectType: storage.M2VirtualDriveConfig
  Enable: true
  ControllerSlot: MSTOR-RAID-1
UnusedDisksState: Jbod
---
ClassId: vnic.EthNetworkPolicy
Name: {{prefix}}fi-control-Trunk
Organization: {{organization}}
#settings
VlanSettings:
  ClassId: vnic.VlanSettings
  ObjectType: vnic.VlanSettings
  AllowedVlans: {{AllowedVlans}}
  DefaultVlan: {{DefaultVLAN}}
  Mode: {{TrunkMode}}
---
ClassId: vnic.EthIf
Name: Eth0
#settings
FailoverEnabled: true
EthAdapterPolicy: MoRef[{{organization}}\{{prefix}}fi-control-Linux]
EthNetworkPolicy: MoRef[{{organization}}\{{prefix}}fi-control-Trunk]
EthQosPolicy: MoRef[{{organization}}\{{prefix}}fi-control-QOS-server]
FabricEthNetworkControlPolicy: MoRef[{{organization}}\{{prefix}}fi-control-LLDP]
FabricEthNetworkGroupPolicy: 
  - MoRef[{{organization}}\{{prefix}}fi-control-ALLOWED-VLANS]
LanConnectivityPolicy: MoRef[{{organization}}\{{prefix}}fi-control-LAN]
MacPool: MoRef[{{organization}}\{{prefix}}macA]
MacAddressType: "POOL"
Order: 0
Placement:
  ClassId: vnic.PlacementSettings
  AutoSlotId: true
  SwitchId: A
---
ClassId: vnic.EthIf
Name: Eth1
#settings
FailoverEnabled: true
EthAdapterPolicy: MoRef[{{organization}}\{{prefix}}fi-control-Linux]
EthNetworkPolicy: MoRef[{{organization}}\{{prefix}}fi-control-Trunk]
EthQosPolicy: MoRef[{{organization}}\{{prefix}}fi-control-QOS-server]
FabricEthNetworkControlPolicy: MoRef[{{organization}}\{{prefix}}fi-control-LLDP]
FabricEthNetworkGroupPolicy: 
  - MoRef[{{organization}}\{{prefix}}fi-control-ALLOWED-VLANS]
LanConnectivityPolicy: MoRef[{{organization}}\{{prefix}}fi-control-LAN]
MacPool: MoRef[{{organization}}\{{prefix}}macB]
MacAddressType: "POOL"
Order: 0
Placement:
  ClassId: vnic.PlacementSettings
  AutoSlotId: true
  SwitchId: B
---
ClassId: boot.PrecisionPolicy
Name: {{prefix}}fi-control-Boot
Organization: {{organization}}
#settings
BootDevices:
- Bootloader:
  ObjectType: boot.LocalDisk
  Enabled: true
  Name: M2
  Slot: MSTOR-RAID
- ObjectType: boot.VirtualMedia
  Enabled: {{bootVMedia}}
  Name: CIMC-DVD
  Subtype: cimc-mapped-dvd
---
ClassId: ipmioverlan.Policy
Name: {{prefix}}fi-control-IPMI
Organization: {{organization}}
#settings
Enabled: {{Enable}}
---
ClassId: kvm.Policy
Name: {{prefix}}fi-control-TunneledKVM
Organization: {{organization}}
#settings
TunneledKvmEnabled: {{AllowTunneledKVM}}
Enable: {{EnableKVM}}
---
ClassId: bios.Policy
Name: {{prefix}}fi-control-BIOS
Organization: {{organization}}
---
ClassId: vnic.LanConnectivityPolicy
Name: {{prefix}}fi-control-LAN
Organization: {{organization}}
#settings
TargetPlatform: FIAttached
---
ClassId: fabric.EthNetworkGroupPolicy
Name: {{prefix}}fi-control-ALLOWED-VLANS
Organization: {{organization}}
VlanSettings:
  ClassId: fabric.VlanSettings
  AllowedVlans: {{AllowedVlans}}
  QinqEnabled: false
  NativeVlan: 1
---
ClassId: fabric.EthNetworkControlPolicy
Name: {{prefix}}fi-control-LLDP
Organization: {{organization}} 
#settings
CdpEnabled: {{CdpEnabled}}
ForgeMac: {{ForgeMac}}
LldpSettings:
  ClassId: fabric.LldpSettings
  ReceiveEnabled: {{ReceiveEnabled}}
  TransmitEnabled: {{TransmitEnabled}}
MacRegistrationMode: {{MacRegistrationMode}}
UplinkFailAction: {{UplinkFailAction}}
---
ClassId: iam.EndPointUserPolicy
Organization: {{organization}}
Name: {{prefix}}fi-control-LocalAdmin
#settings
PasswordProperties:
  ClassId: iam.EndPointPasswordProperties
  EnablePasswordExpiry: {{EnablePasswordExpiry}}
  EnforceStrongPassword: {{EnforceStrongPassword}}
  ForceSendPassword: {{ForceSendPassword}}
  GracePeriod: 0
  NotificationPeriod: 15
  PasswordExpiryDuration: {{PasswordExpiryDuration}}
  PasswordHistory: {{PasswordHistory}}
---
ClassId: iam.EndPointUser
Organization: {{organization}}
Name: admin
---
ClassId: iam.EndPointUserRole
#settings
Enabled: {{iamEnable}}
EndPointRole: 
  - MoRef:iam.EndPointRole[$filter:Type eq 'IMC' and Name eq 'admin']
EndPointUser: MoRef[{{organization}}\admin]
EndPointUserPolicy: MoRef[{{organization}}\{{prefix}}fi-control-LocalAdmin]
Password: {{Password}}
---
ClassId: firmware.Policy
Name: {{prefix}}fi-control-Firmware
Organization: {{organization}}
#settings
ModelBundleCombo:
- BundleVersion: {{BundleVersion}}
  ClassId: firmware.ModelBundleVersion
  ModelFamily: {{ModelFamily}}
  ObjectType: firmware.ModelBundleVersion
TargetPlatform: FIAttached
---
ClassId: vmedia.Policy
Name: {{prefix}}fi-control-vMedia
Organization: {{organization}}
#settings
Enabled: {{vmediaEnable}}
Encryption: {{vmediaEncrypt}}
LowPowerUsb: {{LowPowerUsb}}
Mappings: {{Mappings}}
---
ClassId: vnic.EthQosPolicy
Name: {{prefix}}fi-control-QOS-server
Organization: {{organization}}
---
ClassId: sol.Policy
Name: {{prefix}}fi-control-SOL
Organization: {{organization}}
#settings
Enabled: {{solEnabled}}
---
ClassId: ntp.Policy
Name: {{prefix}}fi-control-NTP
Organization: {{organization}}
#settings
Enabled: {{EnableNTP}}
NtpServers: {{NTPServer}}
---
ClassId: smtp.Policy
Name: {{prefix}}fi-control-SMTP
Organization: {{organization}}
#settings
Enabled: {{EnableSMTP}}
SmtpServer: {{SMTPServer}}
SmtpPort: {{SMTPPort}}
Sender: {{SMTPSender}}
Receivers: [{{Email1}}]
---
ClassId: ssh.Policy
Name: {{prefix}}fi-control-SSH
Organization: {{organization}}
#settings
Enabled: {{EnableSSH}}
Port: {{SSHPort}}
Timeout: {{SSHTimeout}}
---
ClassId: deviceconnector.Policy
Name: {{prefix}}fi-control-DeviceConnector
Organization: {{organization}}
#settings
IntersightOnly: {{IntersightOnly}}
---
ClassId: vnic.EthAdapterPolicy
Name: {{prefix}}fi-control-Linux
Organization: {{organization}}
#settings
AdvancedFilter: false
ArfsSettings:
  ClassId: vnic.ArfsSettings
  Enabled: false
CompletionQueueSettings:
  ClassId: vnic.CompletionQueueSettings
  Count: 2
  RingSize: 1
GeneveEnabled: false
InterruptScaling: false
InterruptSettings:
  ClassId: vnic.EthInterruptSettings
  CoalescingTime: 125
  CoalescingType: MIN
  Count: 4
  Mode: MSIx
NvgreSettings:
  ClassId: vnic.NvgreSettings
  Enabled: false
PtpSettings:
  ClassId: vnic.PtpSettings
  Enabled: false
RoceSettings:
  ClassId: vnic.RoceSettings
  ClassOfService: {{ClassOfService}}
  Enabled: {{rcoeEnable}}
  MemoryRegions: 0
  QueuePairs: {{QueuePairs}}
  ResourceGroups: {{ResourceGroups}}
  Version: {{Version}}
RssHashSettings:
  ClassId: vnic.RssHashSettings
  Ipv4Hash: false
  Ipv6ExtHash: false
  Ipv6Hash: false
  TcpIpv4Hash: false
  TcpIpv6ExtHash: false
  TcpIpv6Hash: false
  UdpIpv4Hash: false
  UdpIpv6Hash: false
RssSettings: false
RxQueueSettings:
  ClassId: vnic.EthRxQueueSettings
  Count: 1
  RingSize: 512
TcpOffloadSettings:
  ClassId: vnic.TcpOffloadSettings
  LargeReceive: {{LargeReceive}}
  LargeSend: {{LargeSend}}
  RxChecksum: {{RxChecksum}}
  TxChecksum: {{TxChecksum}}
TxQueueSettings:
  ClassId: vnic.EthTxQueueSettings
  Count: 1
  RingSize: 256
UplinkFailbackTimeout: 5
VxlanSettings:
  ClassId: vnic.VxlanSettings
  Enabled: false

#### Worker ####

---
ClassId: storage.StoragePolicy
Name: {{prefix}}fi-worker-M.2
Organization: {{organization}}
#settings
M2VirtualDrive:
  ClassId: storage.M2VirtualDriveConfig
  ObjectType: storage.M2VirtualDriveConfig
  Enable: true
  ControllerSlot: MSTOR-RAID-1
UnusedDisksState: Jbod
---
ClassId: vnic.EthNetworkPolicy
Name: {{prefix}}fi-worker-Trunk
Organization: {{organization}}
#settings
VlanSettings:
  ClassId: vnic.VlanSettings
  ObjectType: vnic.VlanSettings
  AllowedVlans: {{workerAllowedVlans}}
  DefaultVlan: {{workerDefaultVLAN}}
  Mode: {{workerTrunkMode}}
---
ClassId: vnic.EthIf
Name: Eth0
#settings
FailoverEnabled: true
EthAdapterPolicy: MoRef[{{organization}}\{{prefix}}fi-worker-Linux]
EthNetworkPolicy: MoRef[{{organization}}\{{prefix}}fi-worker-Trunk]
EthQosPolicy: MoRef[{{organization}}\{{prefix}}fi-worker-QOS-server]
FabricEthNetworkControlPolicy: MoRef[{{organization}}\{{prefix}}fi-worker-LLDP]
FabricEthNetworkGroupPolicy: 
  - MoRef[{{organization}}\{{prefix}}fi-worker-ALLOWED-VLANS]
LanConnectivityPolicy: MoRef[{{organization}}\{{prefix}}fi-worker-LAN]
MacPool: MoRef[{{organization}}\{{prefix}}macA]
MacAddressType: "POOL"
Order: 0
Placement:
  ClassId: vnic.PlacementSettings
  AutoSlotId: true
  SwitchId: A
---
ClassId: vnic.EthIf
Name: Eth1
#settings
FailoverEnabled: true
EthAdapterPolicy: MoRef[{{organization}}\{{prefix}}fi-worker-Linux]
EthNetworkPolicy: MoRef[{{organization}}\{{prefix}}fi-worker-Trunk]
EthQosPolicy: MoRef[{{organization}}\{{prefix}}fi-worker-QOS-server]
FabricEthNetworkControlPolicy: MoRef[{{organization}}\{{prefix}}fi-worker-LLDP]
FabricEthNetworkGroupPolicy: 
  - MoRef[{{organization}}\{{prefix}}fi-worker-ALLOWED-VLANS]
LanConnectivityPolicy: MoRef[{{organization}}\{{prefix}}fi-worker-LAN]
MacPool: MoRef[{{organization}}\{{prefix}}macB]
MacAddressType: "POOL"
Order: 0
Placement:
  ClassId: vnic.PlacementSettings
  AutoSlotId: true
  SwitchId: B
---
ClassId: boot.PrecisionPolicy
Name: {{prefix}}fi-worker-Boot
Organization: {{organization}}
#settings
BootDevices:
- Bootloader:
  ObjectType: boot.LocalDisk
  Enabled: true
  Name: M2
  Slot: MSTOR-RAID
- ObjectType: boot.VirtualMedia
  Enabled: {{bootVMedia}}
  Name: CIMC-DVD
  Subtype: cimc-mapped-dvd
---
ClassId: ipmioverlan.Policy
Name: {{prefix}}fi-worker-IPMI
Organization: {{organization}}
#settings
Enabled: {{Enable}}
---
ClassId: kvm.Policy
Name: {{prefix}}fi-worker-TunneledKVM
Organization: {{organization}}
#settings
TunneledKvmEnabled: {{workerAllowTunneledKVM}}
Enable: {{workerEnableKVM}}
---
ClassId: bios.Policy
Name: {{prefix}}fi-worker-BIOS
Organization: {{organization}}
---
ClassId: vnic.LanConnectivityPolicy
Name: {{prefix}}fi-worker-LAN
Organization: {{organization}}
#settings
TargetPlatform: FIAttached
---
ClassId: fabric.EthNetworkGroupPolicy
Name: {{prefix}}fi-worker-ALLOWED-VLANS
Organization: {{organization}}
VlanSettings:
  ClassId: fabric.VlanSettings
  AllowedVlans: {{workerAllowedVlans}}
  QinqEnabled: false
  NativeVlan: 1
---
ClassId: fabric.EthNetworkControlPolicy
Name: {{prefix}}fi-worker-LLDP
Organization: {{organization}} 
#settings
CdpEnabled: {{workerCdpEnabled}}
ForgeMac: {{workerForgeMac}}
LldpSettings:
  ClassId: fabric.LldpSettings
  ReceiveEnabled: {{workerReceiveEnabled}}
  TransmitEnabled: {{workerTransmitEnabled}}
MacRegistrationMode: {{workerMacRegistrationMode}}
UplinkFailAction: {{workerUplinkFailAction}}
---
ClassId: iam.EndPointUserPolicy
Organization: {{organization}}
Name: {{prefix}}fi-worker-LocalAdmin
#settings
PasswordProperties:
  ClassId: iam.EndPointPasswordProperties
  EnablePasswordExpiry: {{workerEnablePasswordExpiry}}
  EnforceStrongPassword: {{workerEnforceStrongPassword}}
  ForceSendPassword: {{workerForceSendPassword}}
  GracePeriod: 0
  NotificationPeriod: 15
  PasswordExpiryDuration: {{workerPasswordExpiryDuration}}
  PasswordHistory: {{workerPasswordHistory}}
---
ClassId: iam.EndPointUser
Organization: {{organization}}
Name: admin
---
ClassId: iam.EndPointUserRole
#settings
Enabled: {{workeriamEnable}}
EndPointRole: 
  - MoRef:iam.EndPointRole[$filter:Type eq 'IMC' and Name eq 'admin']
EndPointUser: MoRef[{{organization}}\admin]
EndPointUserPolicy: MoRef[{{organization}}\{{prefix}}fi-worker-LocalAdmin]
Password: {{workerPassword}}
---
ClassId: firmware.Policy
Name: {{prefix}}fi-worker-Firmware
Organization: {{organization}}
#settings
ModelBundleCombo:
- BundleVersion: {{workerBundleVersion}}
  ClassId: firmware.ModelBundleVersion
  ModelFamily: {{workerModelFamily}}
  ObjectType: firmware.ModelBundleVersion
TargetPlatform: FIAttached
---
ClassId: vmedia.Policy
Name: {{prefix}}fi-worker-vMedia
Organization: {{organization}}
#settings
Enabled: {{workervmediaEnable}}
Encryption: {{workervmediaEncrypt}}
LowPowerUsb: {{workerLowPowerUsb}}
Mappings: {{workerMappings}}
---
ClassId: vnic.EthQosPolicy
Name: {{prefix}}fi-worker-QOS-server
Organization: {{organization}}
---
ClassId: sol.Policy
Name: {{prefix}}fi-worker-SOL
Organization: {{organization}}
#settings
Enabled: {{workersolEnabled}}
---
ClassId: ntp.Policy
Name: {{prefix}}fi-worker-NTP
Organization: {{organization}}
#settings
Enabled: {{EnableNTP}}
NtpServers: {{NTPServer}}
---
ClassId: smtp.Policy
Name: {{prefix}}fi-worker-SMTP
Organization: {{organization}}
#settings
Enabled: {{EnableSMTP}}
SmtpServer: {{SMTPServer}}
SmtpPort: {{SMTPPort}}
Sender: {{SMTPSender}}
Receivers: [{{Email1}}]
---
ClassId: ssh.Policy
Name: {{prefix}}fi-worker-SSH
Organization: {{organization}}
#settings
Enabled: {{workerEnableSSH}}
Port: {{workerSSHPort}}
Timeout: {{workerSSHTimeout}}
---
ClassId: deviceconnector.Policy
Name: {{prefix}}fi-worker-DeviceConnector
Organization: {{organization}}
#settings
IntersightOnly: {{IntersightOnly}}
---
ClassId: vnic.EthAdapterPolicy
Name: {{prefix}}fi-worker-Linux
Organization: {{organization}}
#settings
AdvancedFilter: false
ArfsSettings:
  ClassId: vnic.ArfsSettings
  Enabled: false
CompletionQueueSettings:
  ClassId: vnic.CompletionQueueSettings
  Count: 2
  RingSize: 1
GeneveEnabled: false
InterruptScaling: false
InterruptSettings:
  ClassId: vnic.EthInterruptSettings
  CoalescingTime: 125
  CoalescingType: MIN
  Count: 4
  Mode: MSIx
NvgreSettings:
  ClassId: vnic.NvgreSettings
  Enabled: false
PtpSettings:
  ClassId: vnic.PtpSettings
  Enabled: false
RoceSettings:
  ClassId: vnic.RoceSettings
  ClassOfService: {{workerClassOfService}}
  Enabled: {{workerrcoeEnable}}
  MemoryRegions: 0
  QueuePairs: {{workerQueuePairs}}
  ResourceGroups: {{workerResourceGroups}}
  Version: {{workerVersion}}
RssHashSettings:
  ClassId: vnic.RssHashSettings
  Ipv4Hash: false
  Ipv6ExtHash: false
  Ipv6Hash: false
  TcpIpv4Hash: false
  TcpIpv6ExtHash: false
  TcpIpv6Hash: false
  UdpIpv4Hash: false
  UdpIpv6Hash: false
RssSettings: false
RxQueueSettings:
  ClassId: vnic.EthRxQueueSettings
  Count: 1
  RingSize: 512
TcpOffloadSettings:
  ClassId: vnic.TcpOffloadSettings
  LargeReceive: {{workerLargeReceive}}
  LargeSend: {{workerLargeSend}}
  RxChecksum: {{workerRxChecksum}}
  TxChecksum: {{workerTxChecksum}}
TxQueueSettings:
  ClassId: vnic.EthTxQueueSettings
  Count: 1
  RingSize: 256
UplinkFailbackTimeout: 5
VxlanSettings:
  ClassId: vnic.VxlanSettings
  Enabled: false